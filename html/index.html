<html>
	<head>
		<title>Alfred Holmes</title>
		<link href='Sobolev_Spaces_on_Manifolds.css' type='text/css' rel='stylesheet' /> 
		<link rel="stylesheet" type="text/css" href="stylesheet.css">
	</head>
	<body>
		<div id="container">
			<div id="header">
				<div id="title">
					<h1>Blog Title</h1>
				</div>
				<div class="links" id="social">
					<ul>
						<li><a href="#">twitter</a></li>
						<li><a href="#">goodreads</a></li>
					</ul>
				</div>
				<div class="links">
					<ul>
						<li><a href="#">Posts</a></li>
						<li><a href="#">Collections</a></li>
						<li><a href="#">About</a></li>
					</ul>
				</div>
			</div>
			<div id="pagecontent">
			<div id="sidebar">
				<h3>Side Content</h3>
				<ul>
					<li><a href="#">Category 1</a></li>
					<li><a href="#">Category 2</a></li>
				</ul>
				<p>Please Donate</p>
			</div>
			<div id="main">   <div class='maketitle'>
                                                                  

                                                                  
                                                                  

                                                                  

<h2 class='titleHead'>Starting a Maths Blog</h2>
<div class='author'></div><br />
<div class='date'><span class='cmr-12'>February 7, 2021</span></div>
   </div>
   <h3 class='likesectionHead'><a id='x1-1000'></a>Contents</h3>
   <div class='tableofcontents'>
   <span class='sectionToc'>1 <a href='#x1-20001' id='QQ2-1-2'>Introduction</a></span>
<br />   <span class='sectionToc'>2 <a href='#x1-30002' id='QQ2-1-3'>Getting <span class='cmti-10'>python </span>scripts to render LaTeX</a></span>
<br />   <span class='sectionToc'>3 <a href='#x1-40003' id='QQ2-1-6'>Django Set Up</a></span>
<br />    <span class='subsectionToc'>3.1 <a href='#x1-50003.1' id='QQ2-1-7'>Backend</a></span>
   </div>
   <h3 class='sectionHead'><span class='titlemark'>1   </span> <a id='x1-20001'></a>Introduction</h3>
<!-- l. 19 --><p class='noindent'>I’ve decided to start blogging about mathematics, and perhaps other things. The
main reason is that it will be a good practice for writing mathematics and will allow
me to share some ideas without them needing to be too polished. Also Terrance Tao
seems to do well with his blog so I think it would be a good idea. I think setting up
the site has been quite interesting - I wanted to find a way to get nice looking
LaTeX<span class='footnote-mark'><a href='Sobolev_Spaces_on_Manifolds2.html#fn1x0'><sup class='textsuperscript'>1</sup></a></span><a id='x1-2001f1'></a> 
into the site. The way I’ve decided to do this is to write all the posts in LaTeX,
convert them to <span class='cmti-10'>HTML </span>using the <span class='cmti-10'>htlatex </span>(through make4ht) and other tools which
allow equations to be rendered in <span class='cmti-10'>SVG </span>graphics. This seems to work well, and the
mathematics is displayed in a nicer way than typical javascript solutions, and the
text doesn’t jump around on the page. For the back end I’ve used the <span class='cmti-10'>python</span>
framework <span class='cmti-10'>django </span>because python. The website can be found here and the work flow
of writing the posts in LaTeX, and then having the site render the LaTeX works
                                                                  

                                                                  
quite well. You can see the project on github. This first post will be an overview
of how I’ve gone about building the system, as I think that will be quite
iteresting.
</p>
   <h3 class='sectionHead'><span class='titlemark'>2   </span> <a id='x1-30002'></a>Getting <span class='cmti-10'>python </span>scripts to render LaTeX</h3>
<!-- l. 21 --><p class='noindent'>The key idea with this blog is to get to render the LaTeXon the webserver into
<span class='cmti-10'>HTML </span>and then serve the static pages. So the idea is to have a wordpress style text
editor back end into which a LaTeXdocument gets pasted. Once the page is saved the
website will compile the LaTeXinto <span class='cmti-10'>HTML </span>automatically and then serve the page.
I’ve considered setting up an email account for the website so that blog posts can get
emailed to it but I think that might be too much work for now. I think the best
way to do this is just to get python call the commends to <span class='cmti-10'>htlatex </span>rather
than looking into the many python libaries that are able to render TeX
documents. A quick google search shows that the <span class='cmti-10'>os </span>python module allows just
that through the <span class='cmti-10'>system </span>function. For example making the file <span class='cmti-10'>cli_text.py</span>
</p><figure class='figure'> 

                                                                  

                                                                  
<a id='x1-30061'></a>
                                                                  

                                                                  
<!-- l. 23 -->
<div class='lstlisting' id='listing-1'><span class='label'><a id='x1-3001r1'></a></span><span class='pcrb7t-'>import</span><span class='pcrr7t-'> os </span><br /><span class='label'><a id='x1-3002r2'></a></span><span class='pcrr7t-'>os.system(’ls’)</span>
</div>
<!-- l. 27 -->
<div class='lstlisting' id='listing-2'><span class='label'><a id='x1-3003r1'></a></span><span class='pcrr8c-'>$</span><span class='pcrr7t-'> python cli_text.py </span><br /><span class='label'><a id='x1-3004r2'></a></span><span class='pcrr7t-'>cli_text.py </span><br /><span class='label'><a id='x1-3005r3'></a></span><span class='pcrr8c-'>$</span>
</div>
<figcaption class='caption'><span class='id'>Figure 1:</span><span class='content'>Running OS commands in a <span class='cmti-10'>python </span>script.</span></figcaption><!-- tex4ht:label?: x1-30061  -->
                                                                  

                                                                  
   </figure>
<!-- l. 34 --><p class='indent'>   And so, once you have a latex script in the working python directory, it will be
quite straightforward to run the LaTeXcommands from within python to render
it to <span class='cmti-10'>HTML </span>and LaTeX, and also perform other operations, for example
rendering the post to a PDF to allow it to be downloaded in PDF form, which
could be useful for longer, more technical posts. For example, we can write
a quick script that renders the script to HTML using <span class='cmti-10'>make4ht </span>and also
renders to a <span class='cmti-10'>PDF </span>and then adds a link to the PDF to the rendered html.
To enter the link to the PDF I copied some code from this <a href='https://stackoverflow.com/questions/35355225/edit-and-create-html-file-using-python'>Stack Overflow
question</a> and did a bit of Googling to get <span class='cmti-10'>BeautifulSoup </span>to do its thing.
</p><figure class='figure'> 

                                                                  

                                                                  
<a id='x1-30392'></a>
                                                                  

                                                                  
<!-- l. 36 -->
<div class='lstlisting' id='listing-3'><span class='label'><a id='x1-3007r1'></a></span><span class='pcrb7t-'>import</span><span class='pcrr7t-'> os, bs4 </span><br /><span class='label'><a id='x1-3008r2'></a></span><span class='pcrr7t-'> </span><br /><span class='label'><a id='x1-3009r3'></a></span><span class='pcrr7t-'>MAKE4HT_FLAGS = ’html,svg’ </span><br /><span class='label'><a id='x1-3010r4'></a></span><span class='pcrr7t-'> </span><br /><span class='label'>
<a id='x1-3011r5'></a></span><span class='pcrb7t-'>def</span><span class='pcrr7t-'> main(filename): </span><br /><span class='label'><a id='x1-3012r6'></a></span><span class='pcrro7t-'>        #render the html</span><span class='pcrr7t-'> </span><br /><span class='label'>
<a id='x1-3013r7'></a></span><span class='pcrr7t-'>        command = ’make4ht ’ + filename + ’.tex ’ + MAKE4HT_FLAGS       </span><br /><span class='label'>
<a id='x1-3014r8'></a></span><span class='pcrr7t-'>        os.system(command) </span><br /><span class='label'><a id='x1-3015r9'></a></span><span class='pcrro7t-'>        #render the pdf</span><span class='pcrr7t-'> </span><br /><span class='label'>
<a id='x1-3016r10'></a></span><span class='pcrr7t-'>        command = ’pdflatex ’ + filename </span><br /><span class='label'>
<a id='x1-3017r11'></a></span><span class='pcrr7t-'>        os.system(command) </span><br /><span class='label'><a id='x1-3018r12'></a></span><span class='pcrr7t-'> </span><br /><span class='label'><a id='x1-3019r13'></a></span><span class='pcrr7t-'>        with </span><span class='pcrb7t-'>open</span><span class='pcrr7t-'>(filename + ’.html’) as f: </span><br /><span class='label'>
<a id='x1-3020r14'></a></span><span class='pcrr7t-'>                txt = f.read() </span><br /><span class='label'><a id='x1-3021r15'></a></span><span class='pcrr7t-'>                webpage = bs4.BeautifulSoup(txt) </span><br /><span class='label'>
<a id='x1-3022r16'></a></span><span class='pcrro7t-'>        #find the datetag</span><span class='pcrr7t-'> </span><br /><span class='label'><a id='x1-3023r17'></a></span><span class='pcrro7t-'>        #this assumes there is a date on the article</span><span class='pcrr7t-'> </span><br /><span class='label'>
<a id='x1-3024r18'></a></span><span class='pcrr7t-'>        datetag = webpage.find_all(’div’, {’class’: ’date’})[0] </span><br /><span class='label'>
<a id='x1-3025r19'></a></span><span class='pcrr7t-'> </span><br /><span class='label'><a id='x1-3026r20'></a></span><span class='pcrr7t-'>        new_tag = webpage.new_tag(’a’, href=filename + ’.pdf’) </span><br /><span class='label'>
<a id='x1-3027r21'></a></span><span class='pcrr7t-'>        new_tag.append(’PDF version’) </span><br /><span class='label'><a id='x1-3028r22'></a></span><span class='pcrr7t-'> </span><br /><span class='label'>
<a id='x1-3029r23'></a></span><span class='pcrr7t-'>        date_tag.insert_after(new_tag) </span><br /><span class='label'>
<a id='x1-3030r24'></a></span><span class='pcrro7t-'>        #write the changes</span><span class='pcrr7t-'> </span><br /><span class='label'><a id='x1-3031r25'></a></span><span class='pcrr7t-'>        with </span><span class='pcrb7t-'>open</span><span class='pcrr7t-'>(filename + ’.html’, ’w’) as f: </span><br /><span class='label'>
<a id='x1-3032r26'></a></span><span class='pcrr7t-'>                f.write(</span><span class='pcrb7t-'>str</span><span class='pcrr7t-'>(webpage)) </span><br /><span class='label'><a id='x1-3033r27'></a></span><span class='pcrr7t-'> </span><br /><span class='label'><a id='x1-3034r28'></a></span><span class='pcrr7t-'> </span><br /><span class='label'>
<a id='x1-3035r29'></a></span><span class='pcrb7t-'>if</span><span class='pcrr7t-'> __name__==’__main__’: </span><br /><span class='label'><a id='x1-3036r30'></a></span><span class='pcrr7t-'>        </span><span class='pcrb7t-'>import</span><span class='pcrr7t-'> sys </span><br /><span class='label'>
<a id='x1-3037r31'></a></span><span class='pcrr7t-'>        filename = sys.argv[1] </span><br /><span class='label'><a id='x1-3038r32'></a></span><span class='pcrr7t-'>        main(filename)</span>
</div>
<figcaption class='caption'><span class='id'>Figure 2:</span><span class='content'>Python script to render a LaTeXfile to HTML and PDF</span></figcaption><!-- tex4ht:label?: x1-30392  -->
                                                                  

                                                                  
   </figure>
<!-- l. 73 --><p class='indent'>   Running this adds a link to the PDF version at the top of the page,
after the date tag. This is just to illustrate the functionality as the idea
in the finished site is just to take the rendered HTML and insert it into a
template with <span class='cmti-10'>Django</span>. This simple script also shows that using python to
automate <span class='cmti-10'>PDF </span>rendering is potentially quite useful for standard desktop
applications.
</p>
   <h3 class='sectionHead'><span class='titlemark'>3   </span> <a id='x1-40003'></a>Django Set Up</h3>
<!-- l. 75 --><p class='noindent'>I’ve made a few websites with the <span class='cmti-10'>Django </span>framework in the past and so headed over
to the Django documentation to get going, as I remembered this being some of the
best documentation around. In the past, the major issues or annoyances I have had
with <span class='cmti-10'>Django </span>have been to do with static files, and I assume the same is going to
happen here. Once the document is rendered to HTML it needs to be saved
on the site and along with all its resources, and have all the image URLs
point to the correct place within <span class='cmti-10'>Django</span>. Following the documentation, I set
up a Django development environment with one class being the article. To
get the project started I followed the first few sections of the tutorial: the
Django API is great, but it is very easy to forget where to begin after a few
years. Luckily (or perhaps well planned by the authors) the django tutorial is
basically all I need for the basic functionality of writing the blog posts: It
creates a Polls website, a website consisting of pages made up of questions
and answers, where as my site will be made up of blog posts and images
which have the same relationship, so I will use a lot of the code from the
tutorial.
</p>
   <h4 class='subsectionHead'><span class='titlemark'>3.1   </span> <a id='x1-50003.1'></a>Backend</h4>
<!-- l. 77 --><p class='noindent'>To set up the simple site, I’ve just got two models: one for the posts and another for
the images or other required files. Each post has a title, its LaTeXcode, an optional
bibliography and a field for its HTML - it might be useful to be able to edit this in
some situations once the page has been rendered. To render the LaTeXinto
HTML we need to run the code in <a href='#x1-30392'>fig. 2</a> once the LaTeXhas been added
and we’ve saved the images to the correct directory - the current plan is to
upload the images to the correct place on the site where they will be stored
(in the <span class='pcrr7t-'>/posts/post_name/</span>) and also save the LaTeXcode there. Then
from python, <span class='pcrr7t-'>cd </span>into that directory and build the HTML and the PDF
there, which will make sure all the image and links work - sometimes the
htlatex will generate extra HTML in footnotes so it will be good to keep that
extra functionality working before it can be implemented into the main
site.
</p><!-- l. 79 --><p class='indent'>   The process to render the HTML is as follows
                                                                  

                                                                  
     </p><ol class='enumerate1'>
     <li class='enumerate' id='x1-5002x1'>Upload the document to the Django server, along with any images / files
     needed for the rendering.
     </li>
     <li class='enumerate' id='x1-5004x2'>When the page is saved, render the HTML for the page.
     </li>
     <li class='enumerate' id='x1-5006x3'>Save this rendered HTML to the Django back end, changing the locations
     of the static files.
     </li>
     <li class='enumerate' id='x1-5008x4'>Use Django to render the HTML with any heading / extra site info linking
     all the correct stylesheets when the page is viewed.</li></ol>
    
				<h1>This is an example post</h1>
				<h3>Section 1</h3>
				<p>This is an example blog post to show the styling. This section of the page is where the rendered HTML gets places. I'm writng this bit to see what happens to the floating content</p>
			</div>
			</div>
			<div id="footer">
			</div>
		</div>
		
	</body>
</html>
